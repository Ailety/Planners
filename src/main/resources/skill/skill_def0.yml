__option__:
  name: '疾风斩击'
  triggers: [ player attack ]
  async: true
  icon:
    material: SWORD_STONE
    name: "&e{{ skill name }}"
    lore:
      - '&f技能等级 &a{{ skill level }}'
      - ''
      - '&f冷却时间 &a{{ lazy get cooldown }}'
      - '&f蓝量消耗 &a{{ lazy get mp }}'
      - ''
      - '&f对前方敌人造成&a{{ lazy get attackCount }}&f段伤害,每段造成&a{{ lazy get damage }}'
      - ''
      - '&fkey -> &a{{ skill key }}'

  variables:
    cooldown: math skill level * 1.5
    mp: skill level
    damage: math lazy get base + papi "%rpg_Damage:physical:min%"
    attackCount: math skill level * 2
    base: 10
action: |-
  set key to inline "mark-{{ player name }}-{{ uuid random }}"
  set loc to executor loc
  origin set executor loc
  global set &key to &loc timeout 600000000
  title "陷阱" subtitle "已安放" by 20 60 20
  async {

    for i in range 1 to 3 then {
      effect circle inline "CLOUD 0 0 0 -step 10 -radius 4 -speed 0.0 -count 10 -@loc {{ &loc }}"
      effect circle inline "CLOUD 0 0 0 -step 10 -radius 3 -speed 0.0 -count 10 -@loc {{ &loc }}"
      effect circle inline "CLOUD 0 0 0 -step 10 -radius 2 -speed 0.0 -count 10 -@loc {{ &loc }}"
      effect circle inline "CLOUD 0 0 0 -step 10 -radius 1 -speed 0.0 -count 10 -@loc {{ &loc }}"
      sleep 1s
    }

  }
  async {
    for i in range 1 to 8 then {
      selector t0 to "-@range 4,4,4 -@their"
      if check selector t0 size >= 1 then {
        damage 2 false "-@fetch t0"
        print "break for"
        exit success
      }
      sleep 1s
    }

  }

  sleep 8s
